/*
 * Copyright 2020,2022 Arm Limited.
 * SPDX-License-Identifier: Apache-2.0
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

bob_shared_library {
    name: "libsharedtest",
    srcs: ["srcs/lib.c"],
    cflags: ["-fPIC"],
    host_supported: true,
    target_supported: true,
}

bob_binary {
    name: "utility",
    srcs: ["srcs/main.c"],
    shared_libs: [
        "libsharedtest",
    ],
    host_supported: true,
    target_supported: true,
}

bob_transform_source {
    name: "gen_output",
    srcs: [
        "input/input_one.in",
        "input/input_two.in",
    ],
    out: {
        match: ".*/([^/]+)\\.(in)",
        replace: ["$1.gen"],
    },
    host_bin: "utility",
    cmd: "${tool} -u ${host_bin} -i ${in} -o ${out}",
    tools: ["transform.py"],
    target: "host",
}

bob_alias {
    name: "bob_test_shared_libs_toc",
    srcs: [
        "gen_output",
    ],
}
